<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro para Empresas - Phortia</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Banner -->
    <header class="banner">
        <img src="imagenes/banner.webp" alt="Phortia Banner" class="banner-image">
        <div class="header-content">
            <img src="imagenes/logo-png.png" alt="Phortia Logo" class="logo">
            <p>Conectando transportistas y empresas de forma inteligente.</p>
        </div>
    </header>

    <!-- Menú de Navegación -->
    <nav class="nav-menu">
        <ul>
            <a href="index.html">Inicio</a>
            <a href="transportistas.html">Registro para Transportistas</a>
            <a href="empresas.html">Registro para Empresas</a>
        </ul>
    </nav>

    <main>
        <!-- Sección 1: Título y mensaje -->
        <section class="section">
            <div class="section-content">
                <h2>¡Registra tu Empresa!</h2>
                <p>Únete a Phortia y encuentra transportistas confiables que se adapten a las necesidades de tu negocio. Optimiza tu logística y accede a una red profesional de transporte.</p>
            </div>
        </section>

        <!-- Sección 2: Formulario de registro -->
        <section class="section">
            <div class="section-content">
                <h2>Datos de Registro</h2>
                <form id="empresaForm" class="registration-form">
                    <div class="form-group">
                        <label for="nombre-empresa">Nombre De La Empresa:</label>
                        <input type="text" id="nombre-empresa" name="nombre-empresa" required>
                    </div>
                    <div class="form-group">
                        <label for="correo">Correo Electrónico:</label>
                        <input type="email" id="correo" name="correo" required>
                    </div>
                    <div class="form-group">
                        <label for="telefono">Teléfono De Contacto:</label>
                        <input type="tel" id="telefono" name="telefono" maxlength="10" required>
                    </div>
                    <div class="form-group">
                        <label for="origen">Origen:</label>
                        <input type="text" id="origen" name="origen" placeholder="Escribe el nombre completo. NO uses abreviaturas" required>
                    </div>
                    <div class="form-group">
                        <label for="destino">Destino:</label>
                        <input type="text" id="destino" name="destino" placeholder="Escribe el nombre completo. NO uses abreviaturas" required>
                    </div>
                    <div class="form-group">
                        <label for="paga">Paga Estimada:</label>
                        <input type="text" id="paga" name="paga" required>
                    </div>
                    <div class="form-group">
                        <label for="das-anticipo">¿Das anticipo?</label>
                        <select id="das-anticipo" name="das-anticipo" required onchange="mostrarPregunta('das-anticipo', 'porcentaje-anticipo-container')">
                            <option value="" disabled selected>Selecciona una opción</option>
                            <option value="si">Sí</option>
                            <option value="no">No</option>
                        </select>
                    </div>
                    <div class="form-group" id="porcentaje-anticipo-container" style="display: none;">
                        <label for="porcentaje-anticipo">¿Qué Porcentaje De Anticipo Das?</label>
                        <input type="number" id="porcentaje-anticipo" name="porcentaje-anticipo" min="1" max="100">
                    </div>                    
                    <div class="form-group">
                        <label for="carga">Tipo De Carga:</label>
                        <input type="text" id="carga" name="carga" required>
                    </div>
                    <div class="form-group">
                        <label for="unidad-requerida">¿Qué Tipo De Unidad Requieres?</label>
                        <input type="text" id="unidad-requerida" name="unidad-requerida" required>
                    </div>
                    <div class="form-group">
                        <label for="peso-transportar">¿Cuánto Peso Vas A Transportar? (Kg)</label>
                        <input type="number" id="peso-transportar" name="peso-transportar" required>
                    </div>
                    <div class="form-group">
                        <label for="ruta-internacional">¿La Ruta Será Internacional?</label>
                        <select id="ruta-internacional" name="ruta-internacional" required>
                            <option value="" disabled selected>Selecciona una opción</option>
                            <option value="si">Sí</option>
                            <option value="no">No</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="ruta-recurrente">¿La Ruta Es Recurrente?</label>
                        <select id="ruta-recurrente" name="ruta-recurrente" required onchange="mostrarPregunta('ruta-recurrente', 'frecuencia-mensual-container')">
                            <option value="" disabled selected>Selecciona una opción</option>
                            <option value="si">Sí</option>
                            <option value="no">No</option>
                        </select>
                    </div>
                    <div class="form-group" id="frecuencia-mensual-container" style="display: none;">
                        <label for="frecuencia-mensual">¿Cuántas Veces Al Mes Requieres Esta Ruta?</label>
                        <input type="number" id="frecuencia-mensual" name="frecuencia-mensual" min="1">
                    </div>
                    <div class="form-group">
                        <label for="fecha-ruta">¿Cuándo Necesitas Que Se Haga La Ruta?</label>
                        <input type="date" id="fecha-ruta" name="fecha-ruta" required>
                    </div>
                    <div class="form-group">
                        <label for="especificaciones">Especificaciones Del Transporte Requerido:</label>
                        <textarea id="especificaciones" name="especificaciones" rows="5" required></textarea>
                    </div>
                    <button type="button" id="submitButton" class="form-button">Registrar Empresa</button>
                </form>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-section social-section">
                <h4>Redes Sociales</h4>
                <div class="social-icons">
                    <a href="#"><img src="imagenes/face-icon.png" alt="Facebook"></a>
                    <a href="#"><img src="imagenes/instagram-icon.png" alt="Instagram"></a>
                    <a href="#"><img src="imagenes/twitter-icon.png" alt="X"></a>
                    <a href="#"><img src="imagenes/link-icon.png" alt="LinkedIn"></a>
                </div>
            </div>
            <div class="footer-logo">
                <a href="index.html"><img src="imagenes/logo-f.png" alt="Phortia Logo" class="footer-logo-image"></a>
            </div>
            <div class="footer-section links-section">
                <h4>Enlaces</h4>
                <ul class="footer-links">
                    <li><a href="transportistas.html">Registro para Transportistas</a></li>
                    <li><a href="empresas.html">Registro para Empresas</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; Copyright © 2025 Phortia - Todos los derechos reservados</p>
        </div>
    </footer>

    <!-- Script para manejar el formulario -->
    <script>
        function mostrarPregunta(selectorId, targetId) {
            const selectedValue = document.getElementById(selectorId).value;
            const targetElement = document.getElementById(targetId);
            if (selectedValue === 'si') {
                targetElement.style.display = 'block';
            } else {
                targetElement.style.display = 'none';
            }
        }
        function validarCamposEmpresa() {
    const requiredFields = [
        'nombre-empresa', 'correo', 'telefono', 'origen', 'destino', 'paga', 
        'carga', 'unidad-requerida', 'peso-transportar', 'ruta-internacional', 
        'ruta-recurrente', 'fecha-ruta', 'das-anticipo'
    ];

    for (let fieldId of requiredFields) {
        const field = document.getElementById(fieldId);
        if (!field.value.trim()) {
            alert(`Por favor, completa el campo: ${field.previousElementSibling.textContent}`);
            field.focus();
            return false;
        }
    }

    // Validar preguntas condicionales
    if (document.getElementById('ruta-recurrente').value === 'si') {
        const frecuenciaMensual = document.getElementById('frecuencia-mensual');
        if (!frecuenciaMensual.value.trim()) {
            alert('Por favor, indica cuántas veces al mes necesitas esta ruta.');
            frecuenciaMensual.focus();
            return false;
        }
    }

    if (document.getElementById('das-anticipo').value === 'si') {
        const porcentajeAnticipo = document.getElementById('porcentaje-anticipo');
        if (!porcentajeAnticipo.value.trim()) {
            alert('Por favor, indica el porcentaje de anticipo que das.');
            porcentajeAnticipo.focus();
            return false;
        }
    }

    return true; // Todos los campos están llenos
}

        document.getElementById('submitButton').addEventListener('click', async () => {
        if (!validarCamposEmpresa()) return;

        const formData = {
            nombre_empresa: document.getElementById('nombre-empresa').value,
            correo: document.getElementById('correo').value,
            telefono: document.getElementById('telefono').value,
            origen: document.getElementById('origen').value,
            destino: document.getElementById('destino').value,
            paga: document.getElementById('paga').value,
            carga: document.getElementById('carga').value,
            unidad_requerida: document.getElementById('unidad-requerida').value,
            peso_transportar: document.getElementById('peso-transportar').value,
            ruta_internacional: document.getElementById('ruta-internacional').value,
            ruta_recurrente: document.getElementById('ruta-recurrente').value,
            frecuencia_mensual: document.getElementById('ruta-recurrente').value === 'no'
                ? document.getElementById('frecuencia-mensual').value
                : null,
            fecha_ruta: document.getElementById('fecha-ruta').value,
            especificaciones: document.getElementById('especificaciones').value,
            das_anticipo: document.getElementById('das-anticipo').value,
            porcentaje_anticipo: document.getElementById('das-anticipo').value === 'si'
                ? document.getElementById('porcentaje-anticipo').value
                : null,
        };

        try {
            const response = await fetch('https://phortia-backend.onrender.com/submit_empresa', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData),
            });

            const result = await response.json();
            if (response.ok) {
                alert(result.message);
                document.getElementById('empresaForm').reset();
            } else {
                alert(`Error: ${result.message}`);
            }
        } catch (error) {
            console.error('Error al registrar la empresa:', error);
            alert('Ocurrió un error. Por favor, intenta de nuevo.');
        }
        });
    </script>
</body>
</html>
